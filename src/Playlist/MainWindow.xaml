<Window x:Class="Playlist.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Playlist"
        mc:Ignorable="d"
        Title="Playlist" Height="600" Width="900" MinHeight="400" MinWidth="600"
        Icon="pack://application:,,,/Assets/icon.ico">
    <Window.Resources>
        <Style TargetType="ListBoxItem">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListBoxItem">
                        <Border Name="Border" Padding="5" SnapsToDevicePixels="True">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#73aaff"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                    <Condition Property="IsSelected" Value="False"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Border" Property="Background" Value="#c9deff"/>
                                <Setter Property="Foreground" Value="Black"/>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <DockPanel>
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="_File">
                <MenuItem Header="_New Playlist" Click="NewPlaylist_Click" />
                <MenuItem Header="_History" Click="History_Click" />
                <MenuItem Header="_Settings" />
                <Separator />
                <MenuItem Header="E_xit" Click="Exit_Click" />
            </MenuItem>
            <MenuItem Header="_About">
                <MenuItem Header="_Playlist" Click="AboutPlaylist_Click" />
                <MenuItem Header="_Ignyos" Click="AboutIgnyos_Click" />
                <Separator />
                <MenuItem Header="_Check for Updates" Click="CheckForUpdates_Click" />
            </MenuItem>
        </Menu>

        <!-- Main Content Area -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250" MinWidth="150" />
                <ColumnDefinition Width="5" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- Left Panel - Playlists -->
            <Border Grid.Column="0" BorderBrush="#DDD" BorderThickness="0,0,1,0" Background="#F5F5F5">
                <DockPanel>
                    <!-- Search and Sort Controls -->
                    <DockPanel DockPanel.Dock="Top" Margin="10">
                        <Button Name="SortMenuButton" DockPanel.Dock="Left" Width="30" Height="30" Margin="0,0,5,0" Content="☰" Click="SortMenu_Click">
                            <Button.ContextMenu>
                                <ContextMenu Name="SortContextMenu">
                                    <MenuItem Header="Sort by create date">
                                        <MenuItem Header="Newest first" Click="SortByCreatedDesc_Click" />
                                        <MenuItem Header="Oldest first" Click="SortByCreatedAsc_Click" />
                                    </MenuItem>
                                    <MenuItem Header="Sort by last played">
                                        <MenuItem Header="Most recent first" Click="SortByPlayedDesc_Click" />
                                        <MenuItem Header="Longest ago first" Click="SortByPlayedAsc_Click" />
                                    </MenuItem>
                                    <MenuItem Header="Sort by name">
                                        <MenuItem Header="A - Z" Click="SortByNameAsc_Click" />
                                        <MenuItem Header="Z - A" Click="SortByNameDesc_Click" />
                                    </MenuItem>
                                </ContextMenu>
                            </Button.ContextMenu>
                        </Button>
                        <TextBox Name="SearchTextBox" Height="30" VerticalContentAlignment="Center" />
                    </DockPanel>

                    <!-- Playlists List -->
                    <ListBox Name="PlaylistsListBox" Margin="10,0,10,10" Background="White"
                             DisplayMemberPath="DisplayText"
                             AllowDrop="True" 
                             PreviewMouseLeftButtonDown="Playlist_PreviewMouseLeftButtonDown"
                             MouseMove="Playlist_MouseMove"
                             DragOver="Playlist_DragOver"
                             Drop="Playlist_Drop">
                        <ListBox.Resources>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListBoxItem">
                                            <Border Name="Border" Padding="2" SnapsToDevicePixels="true">
                                                <ContentPresenter />
                                            </Border>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsSelected" Value="true">
                                                    <Setter TargetName="Border" Property="Background" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ListBox.Resources>
                        <ListBox.ContextMenu>
                            <ContextMenu>
                                <MenuItem Header="Edit" Click="EditPlaylist_Click" />
                                <MenuItem Header="Remove" Click="RemovePlaylist_Click" />
                            </ContextMenu>
                        </ListBox.ContextMenu>
                    </ListBox>
                </DockPanel>
            </Border>

            <!-- GridSplitter -->
            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" />

            <!-- Main Panel - Playlist Items -->
            <DockPanel Grid.Column="2">
                <!-- Playlist Name Banner -->
                <Border DockPanel.Dock="Top" Background="White" Padding="15,8,15,8" BorderBrush="Black" BorderThickness="0,0,0,1">
                    <TextBlock Name="PlaylistNameTextBlock" FontSize="18" FontWeight="SemiBold" Text="Select a playlist" />
                </Border>

                <!-- Playlist Items List -->
                <ListBox Name="PlaylistItemsListBox" Margin="10,0,10,10" Background="White"
                         MouseDoubleClick="PlaylistItem_DoubleClick"
                         AllowDrop="True"
                         PreviewMouseLeftButtonDown="PlaylistItem_PreviewMouseLeftButtonDown"
                         MouseMove="PlaylistItem_MouseMove"
                         DragOver="PlaylistItem_DragOver"
                         Drop="PlaylistItem_Drop">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <!-- Progress Indicator Pill -->
                                <Border Grid.Column="0" Width="50" Height="20" CornerRadius="10" 
                                        Background="White" Margin="0,0,10,0"
                                        BorderThickness="1" BorderBrush="Black">
                                    <TextBlock Text="{Binding ProgressPercentage, StringFormat={}{0}%}" 
                                               FontSize="10" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"/>
                                </Border>
                                <!-- File Name -->
                                <TextBlock Grid.Column="1" Text="{Binding Name}" VerticalAlignment="Center"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                    <ListBox.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Play From Beginning" Click="PlayItem_Click" />
                            <MenuItem Header="Continue" Click="ContinueItem_Click" />
                            <Separator />
                            <MenuItem Header="Rename" Click="RenameItem_Click" />
                            <MenuItem Header="Remove" Click="RemoveItem_Click" />
                        </ContextMenu>
                    </ListBox.ContextMenu>
                </ListBox>
            </DockPanel>
        </Grid>
    </DockPanel>
</Window>
